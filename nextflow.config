
//export NXF_WORK="./nextflow_zwc"

params {
    h =null
    help =null
    isoseq_filelist = "Benchcompare_Isoseq_Samplelist.txt" 
    // "./Isoseq_hifi_samplelist.txt" 
    //a txt file that recording the isoseq_fastq. Each row have two columns as samplename and fastq file name. Each sample's fastq is from Pacbio Isoseq pipeline. 
   
    project= "Benchcompare_Isoseq"  
    //A project atlas for the current Pacbio Isoseq downstream analysis       
   
    Isoseq_DataType="BAM"
    // Pacbio Isoseq data format as Unaligned BAM or flnc transcript fastq files. Only the Pacbio un-aligned bam can be for SMRT processing, including Isoseq lima, isoseq refine.   The flnc transcript fastq/fasta only can be for mapping.   

    genome_build ="hg38"   
    // "hg38(default) | hg19 | b37 | vMg27"
    
    Select_Isoseq_Lima="Y"
    // Whether select to run Isoseq_lima to remove cDNA Primer. Y | N
    Isoseq_Lima {
       ThreadsN=2
       // Thread number for running Isoseq_Lima
    }

    Select_Isoseq_Refine="Y"
    // Whether select to run Isoseq_Refine to remove PolyA tail and artifical concatemers. Y | N
    
    Protocol_Polya="Y" //"Y" | "N"
    //Need to specific whether the FL reads have a poly(A) tail and need to be remove
    
    Isoseq_Refine {
       ThreadsN=2   
       // Thread number for running Isoseq_Refine 
     }

    Select_Isoseq_Cluster="N"
    // Whether select to run Isoseq_Cluster. Y | N
    
    Isoseq_Cluster {
       Cluster_Singleton=""
       //Configure "--singletons" to output the FLNC singletons that could not be clustered. Nothing (default) for exclude singletons. 
        
       ThreadsN=16
       // Thread number for running Isoseq_Cluster
    }
   
    Select_minimap2="Y"
    // Whether select to run minimap2 for isoseq mapping and the downstream function modules. Y | N 
    minmap2 {
       ThreadsN=8
       // Thread number for running Minimap2_Isoseq mapping        
    }

    Select_PBMM2 ="Y"
    // Whether select to run PBMM2 for isoseq mapping and the downstream function modules. Y | N 
    PBMM2 { 
       ThreadsN=8
       // Thread number for running PBMM2_Isoseq mapping   
    }

    Select_SplitNCigarReads="Y"
    // Whether select to run GATK_SplitNCigarReads and the downstream function modules. Y | N 

    Select_Deepvariant="N"
    // Whether select to run Deepvariant SNV calling in the GPU nodes. Y | N  
    Deepvariant {
      // The following two parameters for Deepvariant calling
      vsc_min_fraction_snp = 0.07
      vsc_min_fraction_indel= 0.07
    }    

    Select_SNV_ANNOVAR="N"
    // Whether select to run ANNOVAR for annotating the SNV called by Deepvariant. Y | N  
    
    Select_Isoseq_Collapse="Y"
    // Whether select to run Isoseq_Collapse to use exonic structure to collapse redundant transcripts, and following function modules. Y | N   
    
    Isoseq_Collapse {    
      ThreadsN =8
      // Thread number for running Isoseq_Collapse

      Collaspe_Min_Coverage =0.98
      // Ignore alignments with less than minimum query read coverage. [0.99]

      Collaspe_Min_Identity =0.96  
      // Ignore alignments with less than minimum alignment identity. [0.95]

    }

    Select_Transcript_Classify="Y"
    // Whether select to run Transcript Classify for transcript classification. Y | N
        
    Human_Gencode_DIR="/research/groups/cab/projects/Control/common/Bulk_Isoseq_Nextflow/RefGenomes/Human_hg38_Gencode_v39"
    //Gene code folder download from https://downloads.pacbcloud.com/public/dataset/MAS-Seq/REF-pigeon_ref_sets/Human_hg38_Gencode_v39/
    Transcript_Classify {
       ThreadsN=8
       //Thread number for running Transcript Classification

       cage_refTSS_bed="${Human_Gencode_DIR}/refTSS_v3.3_human_coordinate.hg38.sorted.bed"
       // Sorted and indexed CAGE peaks in BED format
    
       polyA_list="${Human_Gencode_DIR}/polyA.list.txt"
       //polyA motif list in custom format    

    }

    Select_Transcript_Filtering="Y"
    //Whether select to run Transcript filtering after transcript classification. Y | N
    
    Select_IsoQuant="Y"
    //Whether select to run IsoQuant for longread RNAseq Quantification analysis. Y | N 
    IsoQuant {
      ThreadsN=16
      // number of cpus for running multi-thread BAM_QC_bam_coverage
      GENECOD_gtf_db="${Human_Gencode_DIR}/gencode.v39.annotation.sorted.gtf.db"
    }
    
    Python_Script_Path="/research/groups/cab/projects/Control/common/Bulk_Isoseq_Nextflow/Python_script"

    Select_Pigeon_Classify_Report="Y" 
    //Whether select to run Pigeon for Classification and Report generation after run Isoquant. Y | N   
    Pigeon_Classify_Report {
     ThreadsN=16
     gencode_annotation_sorted_gtf="${Human_Gencode_DIR}/gencode.v39.annotation.sorted.gtf"
     cage_peak_sorted_bed="${Human_Gencode_DIR}/refTSS_v3.3_human_coordinate.hg38.sorted.bed"
     polyA_list_txt="${Human_Gencode_DIR}/polyA.list.txt"
     covearge_min_count_10_modified2_sorted_tsv="${Human_Gencode_DIR}/intropolis.v1.hg19_with_liftover_to_hg38.tsv.min_count_10.modified2.sorted.tsv"
    }
   
   Select_PBFusion="Y"  
   // Whether select LongQC for Pacbio Isoseq sequencing QC Analysis.  Y | N
   PBFusion {
     ThreadsN=16
     gencode_annotation_sorted_gtf="${Human_Gencode_DIR}/gencode.v39.annotation.sorted.gtf"
   } 
  
    // The following parameters are related to LongQC
    Select_LongQC_Isoseq="N" //"N"
    // Whether select LongQC for Pacbio Isoseq sequencing QC Analysis.  Y | N 
    LongQC {
      Sequencing_platform="pb-sequel"
      //Longread sequencing platform. pb-sequel | pb-rs2 | ont-ligation | ont-rapid
      NSAMPLE="1000"
      // The number of sequences for sampling. (>0 and <=10000) [Default is 5000]. Samller can   linearly speed up the LongQC processing time, eg. 10 more days at 5000 can reduced to 1 more days at 1000. 
    }

    // The following parameters are related to LongGF
    Select_LongGF="Y" // "N"
    //Whether select LongGF for inter-chromosome Fusion analysis. Y | N 
    LongGF {
      min_overlap_len=100
      // The minimum length of an alignment record overlap with a gene
      bin_size=50
      // The bin size during discretization.
      min_map_len=200
      // A minimum length of an alignment record against the reference genome.
    }
        
    outdir= "." //"/scratch_space/wzhang42"  
    // Output dir for storing the intermediate publishedDir  

    TMP_DIR="/scratch_space/wzhang42/tmp"
    // Tempoary Directory that used to store the intermediate files.  

    //PRIMERS_FA = "/research/groups/crispigrp/projects/crispigrp_cab/common/Pacbio_Isoseq/HiFi_ScIsoseq/Library_Configuration/primers.fasta"

     PRIMERS_FA = "/research/groups/cab/projects/Control/common/Bulk_Isoseq_Nextflow/Primers/lima_primer/primers_NEB_Clontech.fasta" 
    // "/research/groups/crispigrp/projects/crispigrp_cab/common/Pacbio_Isoseq/HiFi_ScIsoseq/Library_Configuration/primers_NEB_Clontech.fasta"
    
    AUTO_DIR ="/research/rgs01/applications/hpcf/authorized_apps/cab/Automation"
    REF_DIR ="${AUTO_DIR}/REF/Homo_sapiens/NCBI"
    
    Build_b37 {
        REFERENCE="${REF_DIR}/GRCh37-lite/bwa-index/GRCh37-lite_wochr/GRCh37-lite.fa"
        GENECODE="/home/wzhang42/Misc_Database/gencode.v40lift37.annotation.gtf"
        
        ANNOVAR_DB="/research/groups/cab/projects/Control/common/scripts/VariantCalling/beta/REF/Homo_sapiens/Annovar/humandb"
        ANNOVAR_PROTOCOL=""
        ANNOVAR_OPERATION=""
        ANNOVAR_CONFIG=""

    }
    
    Build_hg38 {     
        REFERENCE="${Human_Gencode_DIR}/human_GRCh38_no_alt_analysis_set.fasta"
        //"${REF_DIR}/GRCh38_no_alt/bwa-index/0.7.17-r1188/GCA_000001405.15_GRCh38_no_alt_analysis_set.fa"
        GENECODE="${Human_Gencode_DIR}/gencode.v39.annotation.sorted.gtf"
        // GENECODE="/home/wzhang42/Misc_Database/gencode.v41.chr_patch_hapl_scaff.annotation.gtf"
        // GENECODE="/home/wzhang42/Misc_Database/gencode.v41.annotation.gtf"
        // GENECODE="/home/wzhang42/Misc_Database/gencode.v40.basic.annotation.gtf"
        
        ANNOVAR_DB="/research/groups/cab/projects/Control/common/scripts/VariantCalling/beta/REF/Homo_sapiens/Annovar/humandb"

        ANNOVAR_PROTOCOL="refGene,avsnp150,1000g2015aug_all,exac03,exac03nontcga,esp6500siv2_all,gnomad211_exome,gnomad30_genome,dbnsfp35a,revel,intervar_20180118,dbscsnv11,cosmic70,nci60,clinvar_20180603"
		ANNOVAR_OPERATION="g,f,f,f,f,f,f,f,f,f,f,f,f,f,f"
		ANNOVAR_CONFIG="-F ANNOVAR_DATE -F Func.refGene -F Gene.refGene -F GeneDetail.refGene -F ExonicFunc.refGene -F AAChange.refGene -F 1000g2015aug_all -F ExAC_ALL -F ExAC_AFR -F ExAC_AMR -F ExAC_EAS -F ExAC_FIN -F ExAC_NFE -F ExAC_OTH -F ExAC_SAS -F ExAC_nontcga_ALL -F ExAC_nontcga_AFR -F ExAC_nontcga_AMR -F ExAC_nontcga_EAS -F ExAC_nontcga_FIN -F ExAC_nontcga_NFE -F ExAC_nontcga_OTH -F ExAC_nontcga_SAS -F esp6500siv2_all -F gnomAD_exome_ALL -F gnomAD_exome_AFR -F gnomAD_exome_AMR -F gnomAD_exome_ASJ -F gnomAD_exome_EAS -F gnomAD_exome_FIN -F gnomAD_exome_NFE -F gnomAD_exome_OTH -F gnomAD_exome_SAS -F gnomAD_genome_ALL -F gnomAD_genome_AFR -F gnomAD_genome_AMR -F gnomAD_genome_ASJ -F gnomAD_genome_EAS -F gnomAD_genome_FIN -F gnomAD_genome_NFE -F gnomAD_genome_OTH -F SIFT_score -F SIFT_converted_rankscore -F SIFT_pred -F Polyphen2_HDIV_score -F Polyphen2_HDIV_rankscore -F Polyphen2_HDIV_pred -F Polyphen2_HVAR_score -F Polyphen2_HVAR_rankscore -F Polyphen2_HVAR_pred -F LRT_score -F LRT_converted_rankscore -F LRT_pred -F MutationTaster_score -F MutationTaster_converted_rankscore -F MutationTaster_pred -F MutationAssessor_score -F MutationAssessor_score_rankscore -F MutationAssessor_pred -F FATHMM_score -F FATHMM_converted_rankscore -F FATHMM_pred -F PROVEAN_score -F PROVEAN_converted_rankscore -F PROVEAN_pred -F VEST3_score -F VEST3_rankscore -F MetaSVM_score -F MetaSVM_rankscore -F MetaSVM_pred -F MetaLR_score -F MetaLR_rankscore -F MetaLR_pred -F M-CAP_score -F M-CAP_rankscore -F M-CAP_pred -F REVEL_score -F REVEL_rankscore -F MutPred_score -F MutPred_rankscore -F CADD_raw -F CADD_raw_rankscore -F CADD_phred -F DANN_score -F DANN_rankscore -F fathmm-MKL_coding_score -F fathmm-MKL_coding_rankscore -F fathmm-MKL_coding_pred -F Eigen_coding_or_noncoding -F Eigen-raw -F Eigen-PC-raw -F GenoCanyon_score -F GenoCanyon_score_rankscore -F integrated_fitCons_score -F integrated_fitCons_score_rankscore -F integrated_confidence_value -F GERP++_RS -F GERP++_RS_rankscore -F phyloP100way_vertebrate -F phyloP100way_vertebrate_rankscore -F phyloP20way_mammalian -F phyloP20way_mammalian_rankscore -F phastCons100way_vertebrate -F phastCons100way_vertebrate_rankscore -F phastCons20way_mammalian -F phastCons20way_mammalian_rankscore -F SiPhy_29way_logOdds -F SiPhy_29way_logOdds_rankscore -F Interpro_domain -F GTEx_V6p_gene -F GTEx_V6p_tissue -F REVEL -F dbscSNV_ADA_SCORE -F dbscSNV_RF_SCORE -F cosmic70 -F nci60 -F CLNALLELEID -F CLNDN -F CLNDISDB -F CLNREVSTAT -F ALLELE_END -F InterVar_automated -F PVS1 -F PS1 -F PS2 -F PS3 -F PS4 -F PM1 -F PM2 -F PM3 -F PM4 -F PM5 -F PM6 -F PP1 -F PP2 -F PP3 -F PP4 -F PP5 -F BA1 -F BS1 -F BS2 -F BS3 -F BS4 -F BP1 -F BP2 -F BP3 -F BP4 -F BP5 -F BP6 -F BP7 -F dbscSNV_ADA_SCORE -F dbscSNV_RF_SCORE -F cosmic70 -F nci60 -F CLNALLELEID -F CLNDN -F CLNDISDB -F CLNREVSTAT -F CLNSIG -F ALLELE_END"
    }

    Build_hg19 {
        REFERENCE="/research/dept/cab/common/users/wzhang42/truvari_test/ref/human_hs37d5.fasta" 
        GENECODE="/home/wzhang42/Misc_Database/gencode.v19.annotation.gtf"

        ANNOVAR_DB="/research/groups/cab/projects/Control/common/scripts/VariantCalling/beta/REF/Homo_sapiens/Annovar/humandb"
        ANNOVAR_PROTOCOL=""
        ANNOVAR_OPERATION=""
        ANNOVAR_CONFIG=""

    }

    Build_mg27 {
        REFERENCE="${AUTO_DIR}/REF/Mus_musculus/Gencode/M27/GRCm39.primary_assembly.genome.fa"
        GENECODE="${AUTO_DIR}/REF/Mus_musculus/Gencode/M27/gencode.vM27.primary_assembly.annotation.gtf"
        
        ANNOVAR_DB="/research/groups/cab/projects/Control/common/scripts/VariantCalling/beta/REF/Mus_musculus/Annovar/mousedb" 
        ANNOVAR_PROTOCOL="refGene"
	ANNOVAR_OPERATION="g"
	ANNOVAR_CONFIG="-F ANNOVAR_DATE -F Func.refGene -F Gene.refGene -F GeneDetail.refGene -F ExonicFunc.refGene -F AAChange.refGene"  

    }
    
    ANNOVAR
    {
     ANNOVAR_PATH="/research/groups/cab/projects/automapper/common/DIVIA/Nextflow_Divia/Module_Scripts/Variant_ANNOVAR"
     //"/hpcf/apps/annovar/install/030717"
     // The path for perl script table_annovar.pl

     ANNOVAR_DB=""
     //"/research/groups/cab/projects/Control/common/scripts/VariantCalling/beta/REF/Homo_sapiens/Annovar/humandb"
     //"/research/groups/cab/projects/Control/common/scripts/VariantCalling/beta/REF/Mus_musculus/Annovar/mousedb" 

     // Database for ANNOVAR 
     REF_BUILD="${genome_build}" // "hg38"
     // Reference Build for ANNOVAR , hg38|h18|hg19

     PROTOCOL=""
     OPERATION=""
     
     CONFIG_ANNOVAR=""
// "-F ANNOVAR_DATE -F Func.refGene -F Gene.refGene -F GeneDetail.refGene -F ExonicFunc.refGene -F AAChange.refGene -F 1000g2015aug_all -F ExAC_ALL -F ExAC_AFR -F ExAC_AMR -F ExAC_EAS -F ExAC_FIN -F ExAC_NFE -F ExAC_OTH -F ExAC_SAS -F ExAC_nontcga_ALL -F ExAC_nontcga_AFR -F ExAC_nontcga_AMR -F ExAC_nontcga_EAS -F ExAC_nontcga_FIN -F ExAC_nontcga_NFE -F ExAC_nontcga_OTH -F ExAC_nontcga_SAS -F esp6500siv2_all -F gnomAD_exome_ALL -F gnomAD_exome_AFR -F gnomAD_exome_AMR -F gnomAD_exome_ASJ -F gnomAD_exome_EAS -F gnomAD_exome_FIN -F gnomAD_exome_NFE -F gnomAD_exome_OTH -F gnomAD_exome_SAS -F gnomAD_genome_ALL -F gnomAD_genome_AFR -F gnomAD_genome_AMR -F gnomAD_genome_ASJ -F gnomAD_genome_EAS -F gnomAD_genome_FIN -F gnomAD_genome_NFE -F gnomAD_genome_OTH -F SIFT_score -F SIFT_converted_rankscore -F SIFT_pred -F Polyphen2_HDIV_score -F Polyphen2_HDIV_rankscore -F Polyphen2_HDIV_pred -F Polyphen2_HVAR_score -F Polyphen2_HVAR_rankscore -F Polyphen2_HVAR_pred -F LRT_score -F LRT_converted_rankscore -F LRT_pred -F MutationTaster_score -F MutationTaster_converted_rankscore -F MutationTaster_pred -F MutationAssessor_score -F MutationAssessor_score_rankscore -F MutationAssessor_pred -F FATHMM_score -F FATHMM_converted_rankscore -F FATHMM_pred -F PROVEAN_score -F PROVEAN_converted_rankscore -F PROVEAN_pred -F VEST3_score -F VEST3_rankscore -F MetaSVM_score -F MetaSVM_rankscore -F MetaSVM_pred -F MetaLR_score -F MetaLR_rankscore -F MetaLR_pred -F M-CAP_score -F M-CAP_rankscore -F M-CAP_pred -F REVEL_score -F REVEL_rankscore -F MutPred_score -F MutPred_rankscore -F CADD_raw -F CADD_raw_rankscore -F CADD_phred -F DANN_score -F DANN_rankscore -F fathmm-MKL_coding_score -F fathmm-MKL_coding_rankscore -F fathmm-MKL_coding_pred -F Eigen_coding_or_noncoding -F Eigen-raw -F Eigen-PC-raw -F GenoCanyon_score -F GenoCanyon_score_rankscore -F integrated_fitCons_score -F integrated_fitCons_score_rankscore -F integrated_confidence_value -F GERP++_RS -F GERP++_RS_rankscore -F phyloP100way_vertebrate -F phyloP100way_vertebrate_rankscore -F phyloP20way_mammalian -F phyloP20way_mammalian_rankscore -F phastCons100way_vertebrate -F phastCons100way_vertebrate_rankscore -F phastCons20way_mammalian -F phastCons20way_mammalian_rankscore -F SiPhy_29way_logOdds -F SiPhy_29way_logOdds_rankscore -F Interpro_domain -F GTEx_V6p_gene -F GTEx_V6p_tissue -F REVEL -F dbscSNV_ADA_SCORE -F dbscSNV_RF_SCORE -F cosmic70 -F nci60 -F CLNALLELEID -F CLNDN -F CLNDISDB -F CLNREVSTAT -F ALLELE_END -F InterVar_automated -F PVS1 -F PS1 -F PS2 -F PS3 -F PS4 -F PM1 -F PM2 -F PM3 -F PM4 -F PM5 -F PM6 -F PP1 -F PP2 -F PP3 -F PP4 -F PP5 -F BA1 -F BS1 -F BS2 -F BS3 -F BS4 -F BP1 -F BP2 -F BP3 -F BP4 -F BP5 -F BP6 -F BP7 -F dbscSNV_ADA_SCORE -F dbscSNV_RF_SCORE -F cosmic70 -F nci60 -F CLNALLELEID -F CLNDN -F CLNDISDB -F CLNREVSTAT -F CLNSIG -F ALLELE_END"
     CONFIG_STANDARD="-F CHROM -F POS -F ID -F REF -F ALT -F QUAL -F FILTER"
     CONFIG_INFO="-F DP -F SOMATIC -F SS -F SSC -F GPV -F SPV"
     CONFIG_FORMAT="-GF GT -GF GQ -GF DP -GF RD -GF AD -GF FREQ -GF DP4"
   }     
}

profiles {

    local {
        process.executor = 'local'
               
        process {
           withName:Isoseq_Lima {
           module = 'smrttools/25.1'
           memory = '40GB'
           cpus = "${params.Isoseq_Lima.ThreadsN}"
           }
        }

        process {
           withName:Isoseq_Refine {
           module = 'smrttools/25.1'
           memory = '40GB'
           cpus = "${params.Isoseq_Refine.ThreadsN}"
           }
        }

        process {
           withName:Isoseq_Cluster {
           module = 'smrttools/25.1'
           memory = '20GB'
           cpus = "${params.Isoseq_Cluster.ThreadsN}"
           }
	}
        
        process {
           withName:Pacbio_BAM_To_Fasta {
           module = 'smrttools/25.1'  //smrttools/13.0
           memory = '80GB'
           }
        }
        
        process {
           withName:LongQC_Isoseq {
           module = ['samtools/1.17', 'longqc/030822']
           memory = '80GB'
           } 
        }
        
        process {    
            withName: minimap2_isoseq_mapping {
	    module = ['samtools/1.17', 'smrttools/25.1']
            memory = '400GB'
            cpus = "${params.minimap2.ThreadsN}"
	    }  
        }
        
       process {    
            withName: PBMM2_Isoseq_mapping {
            module = 'smrttools/25.1'
            memory = '40GB'
            cpus = "${params.PBMM2.ThreadsN}"
            }
       }
       
       process {    
            withName: GATK_SplitNCigarReads {
            module = 'gatk/4.1.8.0' 
            memory = '64GB'
            }
       }
       
       process {    
            withName: SNV_Deepvariant {
            queue =  'rhel8_gpu'
            memory = '80GB' 
            clusterOptions= '-gpu "num=2/host:mode=shared" -app parabricks-4.0.1-1-cab-a100'
            }
        }
        
        process {
            withName: SNV_Variant_Filtering {
            memory = '16G'
            }
	}

	process {
            withName: Variant_SNV_ANNOVAR {
            module = ['perl/5.28.1', 'tabix/0.2.6', 'gatk/4.1.8.0']
            memory = '32GB'
            }
	}

        process {    
            withName: LongGF {
	    module = ['samtools/1.17', 'longgf/0.1.2']
            memory = '100GB'
	    }  
        }

        process {
           withName:Isoseq_Collapse {
           module = 'smrttools/25.1'
           memory = '40GB'
           cpus = "${params.Isoseq_Collapse.ThreadsN}"
           }
        }

        process {
           withName:Transcript_Classify {
           module = 'smrttools/25.1'
           memory = '40GB'
           cpus = "${params.Transcript_Classify.ThreadsN}"
           }
        }
        
       process {
           withName:Transcript_Filtering {
           module = 'smrttools/25.1'
           memory = '40GB'
           }
        }

       process {
           withName:IsoQuant {
           module = ['minimap2/2.26','isoquant/3.7.0','tabix/0.2.6']
           memory = '40GB'
           cpus = "${params.IsoQuant.ThreadsN}"
           }
       }

       process { 
           withName:Isoquant2Pigeon {
           module = 'python/3.7.0'
       	   memory = '8GB'
          }
       }

       process { 
           withName:Pigeon_Classify_Report {
           module = 'smrttools/25.1'
           memory = '40GB'
           cpus = "${params.Pigeon_Classify_Report.ThreadsN}"
          }
       }

       process {
           withName:PBFusion {
           module = 'pbfusion/0.5.0'
           memory = '8GB'
           cpus = "${params.PBFusion.ThreadsN}" 
           }
       }
        
    }

    cluster {
        process.executor = 'lsf'
        executor.queueSize = 200
        process.queue =  'heavy_io'
        process.scratch=true
        process.clusterOptions = '-P Test'
        executor.jobName = { "$task.name - $task.hash" }  
        
        process {
           withName:Isoseq_Lima {
           module = 'smrttools/25.1'
           memory = '40GB'
           cpus = "${params.Isoseq_Lima.ThreadsN}"
           }
        }

        process {
           withName:Isoseq_Refine {
           module = 'smrttools/25.1'
           memory = '40GB'
           cpus = "${params.Isoseq_Refine.ThreadsN}"
           }
        } 
       
        process {
           withName:Isoseq_Cluster {
           module = 'smrttools/25.1'
           memory = '20GB'
           cpus = "${params.Isoseq_Cluster.ThreadsN}"
           }
       	}       

        process {
           withName:Pacbio_BAM_To_Fasta {
           module = 'smrttools/25.1'
           memory = '80GB'
           }
        }

        process {
           withName:LongQC_Isoseq {
           module = ['samtools/1.17', 'longqc/030822']
           memory = '160GB'
           } 
        }
        
        process {    
            withName: minimap2_isoseq_mapping  {
	        module = ['samtools/1.17', 'smrttools/25.1'] 
                cpus = "${params.minmap2.ThreadsN}"
	        memory= '40GB' 
	        }
        }

        process {    
            withName: PBMM2_Isoseq_mapping {
            module = 'smrttools/25.1'
            memory = '40GB'
            cpus = "${params.PBMM2.ThreadsN}"
            }
       }
       
       process {    
            withName: GATK_SplitNCigarReads {
            module = 'gatk/4.1.8.0' 
            memory = '64GB'

            }
       }
       
       process {    
            withName: SNV_Deepvariant {
            queue =  'gpu' 
            memory = '200G'
            clusterOptions= '-gpu "num=2/host:mode=shared" -app parabricks-4.0.1-1-cab-a100'    
            }
        }

        process {    
            withName: SNV_Variant_Filtering { 
            memory = '16G'    
            }
        }

        process {    
            withName: Variant_SNV_ANNOVAR { 
            module = ['perl/5.28.1', 'tabix/0.2.6', 'gatk/4.1.8.0'] 
            memory = '32GB'    
            }
        }
        
        process {    
            withName: LongGF {
	    module = ['samtools/1.17', 'longgf/0.1.2']
            memory = '100GB'
	    }  
        }
        
        process {
           withName:Isoseq_Collapse {
           module = 'smrttools/25.1'
           memory = '40GB'
           cpus = "${params.Isoseq_Collapse.ThreadsN}"
           }
        }

        process {
           withName:Transcript_Classify {
           module = 'smrttools/25.1'
           memory = '40GB'
           cpus = "${params.Transcript_Classify.ThreadsN}"
           }
        }

       process {
           withName:Transcript_Filtering {
           module = 'smrttools/25.1'
           memory = '40GB'
           }
       } 
      
      process {
           withName:IsoQuant {
           module = ['minimap2/2.26','isoquant/3.7.0', 'tabix/0.2.6']
       	   memory = '40GB'
       	   cpus = "${params.IsoQuant.ThreadsN}"
           }
       }

       process {
           withName:Isoquant2Pigeon {
           module = 'python/3.7.0'
           memory = '8GB'
          }
       }

       process {
           withName:Pigeon_Classify_Report {
           module = 'smrttools/25.1'
       	   memory = '40GB'
       	   cpus = "${params.Pigeon_Classify_Report.ThreadsN}"
          }
       }
       
       process {
       	   withName:PBFusion {
           module = 'pbfusion/0.5.0'
           memory = '8GB'
       	   cpus = "${params.PBFusion.ThreadsN}"
       	   }
       }
    } 
    
}


